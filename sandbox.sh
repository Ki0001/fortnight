#================================================================================================================================
#================================================================================================================================

path="foo.bar.baz"
echo $(echo $path | awk -F. '{
  printf "[";
  for (i = 1; i <= NF; i++) {
    if (i > 1) {
      printf ",";
    }
    printf "\""$i"\"";
  }
  printf "]";
}')

#================================================================================================================================
#================================================================================================================================

cat example.json | ./JSON.sh -b | egrep '\[\d+,' | awk -F, 'BEGIN{max==""} {gsub("\\[","", $1)} ($1 > max) {max=$1} END{print max}'

#================================================================================================================================
#================================================================================================================================

#!/usr/bin/env bash

get_key () {
  echo $1 | awk -F. '{
    printf "[";
    for (i = 1; i <= NF; i++) {
      if (i > 1) {
        printf ",";
      }
      printf "\""$i"\"";
    }
    printf "]";
  }'
}

jsonv () {
  local keys=()
  for path in ${1//,/ }; do
    keys+=($(get_key $path))
  done

  OIFS=$IFS
  IFS=$'\n\r'

  echo `cat /dev/stdin`

  local parsed=()
  parsed+=(`cat /dev/stdin | ./json.sh -b`)
  local count=$(IFS=$'\n'; echo "${parsed[*]}" | egrep '\[\d+,' | awk -F, 'BEGIN{max==""} {gsub("\\[", "", $1)} ($1 > max) {max=$1} END{print max}')

  echo "Keys: (${#keys[@]})"
  for line in "${keys[@]}"; do
    echo $line
  done

  echo "Parsed: (${#parsed[@]})"
  for line in "${parsed[@]}"; do
    echo $line | awk -F\t '{print $2}'
  done

  echo "Count: $count"

  IFS=$OIFS
}

if [ "$1" != "" ]; then
  jsonv $1
fi

#================================================================================================================================
#================================================================================================================================